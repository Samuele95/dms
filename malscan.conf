# ============================================
# Malscan Configuration File
# ============================================
# Copy this file to ~/.malscan.conf or /etc/malscan.conf
# Command-line options override these settings
#

# ============================================
# Database and Rules Paths
# ============================================

# ClamAV database directory
CLAMDB_DIR=/tmp/clamdb

# YARA rules base directory (Qu1cksc0pe)
YARA_RULES_BASE=/opt/Qu1cksc0pe/Systems

# Oledump YARA rules for document analysis
OLEDUMP_RULES=/opt/oledump

# YARA compiled rules cache directory
YARA_CACHE_DIR=/tmp/yara_cache

# ============================================
# Performance Settings
# ============================================

# Chunk size in MB for scanning (default: 500)
# Larger chunks use more memory but may be faster
CHUNK_SIZE=500

# Maximum parallel jobs for parallel scanning mode
# Recommended: number of CPU cores
MAX_PARALLEL_JOBS=4

# ============================================
# VirusTotal Integration
# ============================================

# VirusTotal API key (required for --virustotal option)
# Get your free API key at: https://www.virustotal.com/gui/join-us
# VT_API_KEY=your_api_key_here

# Rate limit for VirusTotal API (requests per minute)
# Free API: 4 req/min, Premium: higher limits
VT_RATE_LIMIT=4

# ============================================
# Logging Settings
# ============================================

# Log level: DEBUG, INFO, WARNING, ERROR
# DEBUG: Show all messages including debug info
# INFO: Normal operation messages (default)
# WARNING: Warnings and errors only
# ERROR: Errors only
LOG_LEVEL=INFO

# ============================================
# Portable Tools Settings
# ============================================

# Directory for portable tools (used with --portable flag)
# Tools are downloaded here if not available system-wide
PORTABLE_TOOLS_DIR=/tmp/malscan_portable_tools

# Tool versions for portable downloads
YARA_VERSION=4.5.0
CLAMAV_VERSION=1.3.1

# ============================================
# EWF/Forensic Image Support
# ============================================

# Enable EWF (Expert Witness Format) image support
EWF_SUPPORT=true

# Verify EWF hash before scanning (slower but forensically sound)
# Set to true to always verify, or use --verify-hash on command line
EWF_VERIFY_HASH=false

# Additional options to pass to ewfmount
# Example: EWF_MOUNT_OPTIONS="-f ewf"
EWF_MOUNT_OPTIONS=""

# Base directory for temporary mount points (EWF virtual devices)
TEMP_MOUNT_BASE=/tmp

# ============================================
# Scan Scope Settings
# ============================================

# Default scan mode: "full" (entire drive) or "slack" (unallocated only)
DEFAULT_SCAN_MODE=full

# Slack space extraction timeout in seconds
SLACK_EXTRACT_TIMEOUT=600

# Minimum slack space size in MB to analyze (skip if smaller)
SLACK_MIN_SIZE_MB=10

# Maximum number of files to carve/recover from slack space
MAX_CARVED_FILES=1000

# File carving tools to use (comma-separated): foremost,photorec,scalpel
# Note: photorec requires manual interaction, so only foremost is enabled by default
CARVING_TOOLS=foremost

# ============================================
# Forensic Analysis Settings
# ============================================

# Enable full forensic artifact analysis (all modules below)
FORENSIC_ANALYSIS=false

# Persistence mechanism scanning (registry, tasks, services)
PERSISTENCE_SCAN=false

# Execution artifact analysis (prefetch, amcache, shimcache)
EXECUTION_SCAN=false

# File anomaly detection (timestomping, ADS, suspicious paths)
FILE_ANOMALIES=false

# Reverse engineering triage (capa, imports, entropy)
RE_TRIAGE=false

# MFT and filesystem forensics
MFT_ANALYSIS=false

# RegRipper path (for persistence/execution analysis)
# REGRIPPER_PATH=/opt/regripper

# capa binary path (for RE triage)
# CAPA_PATH=/opt/capa/capa

# ============================================
# Display Options
# ============================================

# Disable colored output (equivalent to --no-color)
NO_COLOR=false

# High contrast mode - bold text only, no dim colors
HIGH_CONTRAST=false

# ============================================
# Notes
# ============================================
# - Lines starting with # are comments
# - Values can be quoted or unquoted
# - Environment variables are NOT expanded
# - Command-line options override config file settings
#
# Supported image formats:
#   - EWF/E01: Expert Witness Format (.E01, .E02, ... .Ex01, .L01, .Lx01)
#   - RAW: Raw disk images (.raw, .dd, .img, .bin)
#
# Example usage:
#   ./malware_scan.sh /dev/sdb1 --config /path/to/custom.conf
#   ./malware_scan.sh evidence.E01               # Auto-detect EWF
#   ./malware_scan.sh evidence.E01 --verify-hash # Verify integrity first
#   ./malware_scan.sh /dev/sdb1 --slack          # Slack space only scan
#   ./malware_scan.sh evidence.E01 --scan-mode slack  # EWF slack space scan
#
# Forensic analysis examples:
#   ./malware_scan.sh evidence.E01 --forensic-analysis  # Full forensic suite
#   ./malware_scan.sh /dev/sdb1 --persistence-scan      # Persistence only
#   ./malware_scan.sh evidence.E01 --re-triage          # RE triage on carved files
#   ./malware_scan.sh /dev/sdb1 --mft-analysis          # MFT/filesystem forensics
#
